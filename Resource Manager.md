
![[resource-manager-hierarchy-and-billing.png]]

## [[Identity and Access Management (IAM)|Identity and Access Management]]
- Contain a set of roles and members (principals) and conditions
- Resources inherit policies from parent
- Resource policies are a union of all policies from parents and resource itself
- Deny policies assigned to resources prevent principals from using permissions regardless of roles they are granted

## Billing and Resource Monitoring
- Billing is accumulated from bottom up
- Resource consumption measured in quantities e.g. rate of use, number of items, features used
- Projects accumulate the billing for its resources
- Project associated with one billing account, Organization contains all billing accounts

## [[Resource Hierarchy]] and [[Resource Hierarchy#Projects|Projects]]

- Projects
	- Track resource and quota usage 
	- Manage permissions and credentials
	- Enable services and APIs
- Projects use three identifying attributes:
	- Project Name - human readable way to identify projects, not used by Google APIs
	- Project Number - automatically generated by server, assigned to project
	- Project ID - unique ID generated from your project name

All resources are allocated to projects for billing, regardless of whether they are global, regional or zonal. 

![[resource-project-allocation.png]]


## Project Quotas or Limits

- Prevent runaway consumption in case of error or malicious activity
- Prevent billing spikes or surprises
- Typically fall into one of three categories
	- How many of resource type can be created per project - e.g. default limit of 15 [[Virtual Private Cloud|VPC]] per project
	- Rate limits for requests to APIs - e.g. Cloud Spanner limited to 5 admin actions / second
	- Number of resources per region - e.g. 24 CPUs per region / project by default
- Quotas can be increased by requesting quota adjustments from quotas page in Cloud console
- Should be reviewed periodically
- Quotas do not guarantee a resource will be available - e.g. if region is out of SSD, cannot create SSD in that region regardless of quota


## Labels
- Attached to resources - VM, disk, snapshot, image, etc
- Key value pairs
- Up 64 labels per resource
- Assigned via Cloud console, `gcloud`, API

### Example Label Types
- Team or Cost Center
- Components - e.g. `redis`, `frontend`
- Environment or stage
- Owner or primary contact
- State - e.g. `inuse`, `readyfordeletion`

### Labels vs Network Tags
- Labels
	- Organize resources across Google Cloud
	- User defined strings in key/value format
	- Propagated through billing
- Network tags
	- User-defined strings
	- Primarily used for networking (firewall rules)


## Billing

### Budget
- Allows tracking how spend is growing toward a set amount.
- Set at specific amount or matching previous month's spend

### Alerts
- Can be set up to alert when budget percentage is reached
	- e.g. 50%, 90%, 100%
- Can also set up to alert when spend is forecasted to exceed percentage of budget
- Deliverable via email, pub/sub
	- Allows creating cloud functions listen to alerts and automate cost management

### Analysis
- Label resources in ways that are useful for analysis 
- Export billing data to BigQuery to analyze spend
- Can also export to file and store in Cloud Storage
- Visualize spend over time with [[Looker Studio]] to create dashboards



